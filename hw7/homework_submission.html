
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Homework Submission &#8212; ESE5320 Handouts Fall 2025</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hw7/homework_submission';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/penn_engineering.png" class="logo__image only-light" alt="ESE5320 Handouts Fall 2025 - Home"/>
    <script>document.write(`<img src="../_static/penn_engineering.png" class="logo__image only-dark" alt="ESE5320 Handouts Fall 2025 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Overview
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://www.seas.upenn.edu/~ese5320/fall2025/fall2025.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writeup_guidelines.html">Writeup Guidelines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw0/index.html">Diagnostic Assessment</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw0/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw0/questions.html">Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw0/homework_submission.html">Homework Submission</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw1/index.html">HW1 – Remember C</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw1/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/walk_through.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/makefile_tutorial.html">Makefile Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/gdb_tutorial.html">GDB Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/c_refresher.html">C Refresher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/debug_app.html">Debug an Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/homework_submission.html">Homework Submission</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw2/index.html">HW2 – Profiling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw2/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw2/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw2/homework_submission.html">Homework Submission</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw3/index.html">HW3 – Thread Parallel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw3/collaboration.html">Collaboration</a></li>

<li class="toctree-l2"><a class="reference internal" href="../hw3/u96v2_setup.html">Ultra96 Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw3/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw3/homework_submission.html">Homework Submission</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw4/index.html">HW4 – SIMD</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw4/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw4/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw4/homework_submission.html">Homework Submission</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/icgrp/ese532_handouts" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/icgrp/ese532_handouts/edit/master/ese532_handouts/hw7/homework_submission.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/icgrp/ese532_handouts/issues/new?title=Issue%20on%20page%20%2Fhw7/homework_submission.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/hw7/homework_submission.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Homework Submission</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">Deliverables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="homework-submission">
<h1>Homework Submission<a class="headerlink" href="#homework-submission" title="Link to this heading">#</a></h1>
<p>Your writeup should follow <a class="reference internal" href="../writeup_guidelines.html"><span class="doc std std-doc">the writeup guidelines</span></a>.
Your writeup should include your answers to the questions below. Even if a certain
is just a “step”, please include it in your report and leave the bullet blank
for the sake of easy grading.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the last part of this assignment could take longer than the previous parts.</p>
</div>
<style type="text/css">
    ol { list-style-type: decimal; }
    ol ol { list-style-type: lower-alpha; }
    ol ol ol { list-style-type: lower-roman; }
    table { width: 100%; }
    td {height:50px;text-align: center;}
    tr:nth-child(even) {background-color: #f2f2f2;}
</style>
<!-- 1. **Accelerating the Differentiate**
   1. Create a new Vitis HLS project and add the provided source files.
      Use a clock `xczu3eg-sbva484-1-i` in the device selection. Use a **150 MHz** clock, 
      and select the **Vitis Kernel Flow Target** for the Flow Target.
      Write a testbench that invokes the hardware implementation
      that you will write later, `Differentiate_HW`. You can use the testbench from HW5 as
      a reference. The testbench should compare the result of `Differentiate_SW` and 
      `Differentiate_HW` and exit your program with a value
      of 1 if the output is not correct.
      The input of the functions can be arbitrary values.
      Verify that your test function works. Include the
      testbench in your report.
   1. How many times does `Differentiate_SW` load each pixel on average(ignoring the edge)? (1 line)
   1. Can we use streaming in `Differentiate_SW` to handle arbitrary large frames?
      Assume that we do not change the code except for adding pragmas and changing
      the dimensions of the data. Motivate your answer. (1 line)
   1. We could store pixels that are used multiple times in a buffer that is mapped to
      a local memory. Assuming we still produce the output pixels in the same order,
      what is the smallest buffer that we can use? Motivate your answer. (3 lines) -->
   <!-- 1. In some iterations, we must write a value to the local memory and read multiple
      values. An array is typically mapped on a BRAM, which has only two ports.
      Consequently, we need more bandwidth than the BRAM offers. Give two ways in
      which we could resolve this issue. (4 lines) -->
   <!-- 1. Implement the function `Differentiate_HW` that exploits **data reuse**. 
      It loads the input pixels only once and sequentially. 
      Verify your code using your test function. Include the test function's output and the
      `Differentiate_HW` function in your report. The test function's output could be simply
      "TEST PASSED" depending on your implementation of testbench.
   1. Pipeline the loop body of your implementation with an II of 1. What is the
      latency(in cycles) that Vitis HLS predicts?  -->
   <!-- You can ignore whether Vitis HLS meets
         the clock period or not for now. -->
   <!-- 1. On a microprocessor, branches are generally undesirable because they introduce
      delays when they are predicted wrong. Why is this not a problem in a HW accelerator? -->
<ol class="arabic">
<li><p><strong>Accelerating the Filter horizontal</strong></p>
<ol class="arabic">
<li><p>Create a new Vitis HLS project and add the provided source files.
Use a clock <code class="docutils literal notranslate"><span class="pre">xczu3eg-sbva484-1-i</span></code> in the device selection. Use a <strong>150 MHz</strong> clock,
and select the <strong>Vitis Kernel Flow Target</strong> for the Flow Target.</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">Filter_horizontal</span></code> offer any opportunity for data reuse?
What is the smallest buffer that we can use? (3 lines)</p></li>
<li><p>What is the optimal order for traversing the input data (column-wise or row-wise)?
Assume that the input and output are stored in a BRAM. Motivate your
answer. (3 lines)</p></li>
<li><p>Create a function <code class="docutils literal notranslate"><span class="pre">Filter_horizontal_HW</span></code> that is a version of <code class="docutils literal notranslate"><span class="pre">Filter_horizontal_SW</span></code>
that you modified based on the insights from the previous two questions. You
don’t have to use the streams at this point. Include the code in your report.</p></li>
<li><p>Pipeline the loop body of <code class="docutils literal notranslate"><span class="pre">Filter_horizontal_HW</span></code>. Write a testbench to verify
<code class="docutils literal notranslate"><span class="pre">Filter_horizontal_HW</span></code>.
Similar to the one we used in HW5, the testbench should compare the result of
<code class="docutils literal notranslate"><span class="pre">Filter_horizontal_SW</span></code> and <code class="docutils literal notranslate"><span class="pre">Filter_horizontal_HW</span></code> and exit your program with a value
of 1 if the output is not correct.
If the output is correct, the testbench can simply print out “TEST PASSED”.
The input of the functions can be arbitrary values.
Verify that your test function works. Include the testbench in your report.
What is the latency(in cycles) that Vitis HLS predicts? (1 line)</p>
<!-- You can
ignore whether Vitis HLS meets the clock period or not for now. (1 line) -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure you’ve selected the correct top function for the synthesis.
Also check that you are not forcing another function as the top function in
your constraints file like <code class="docutils literal notranslate"><span class="pre">directives.tcl</span></code>.
You can create multiple Solutions in Vitis HLS for convenience.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that <code class="docutils literal notranslate"><span class="pre">malloc()</span></code> is not synthesizable.
You can have user-defined macro to seperate simulation code and synthesis code as shown in
<a class="reference external" href="https://docs.xilinx.com/r/2020.2-English/ug1399-vitis-hls/Dynamic-Memory-Usage">HLS user guide</a>.</p>
</div>
   <!-- ```{hint}
   Try to achieve latency of <130000 cycles for `Filter_horizontal_HW`.
   ``` -->
</li>
</ol>
</li>
<li><p><strong>Accelerating the Filter vertical</strong></p>
<ol class="arabic">
<li><p>Let’s continue with accelerating <code class="docutils literal notranslate"><span class="pre">Filter_vertical_HW</span></code>.
We could store pixels that
are used multiple times in a buffer that is mapped to a local memory. Assuming
we still produce the output pixels in the same order as <code class="docutils literal notranslate"><span class="pre">Filter_horizontal_HW</span></code>,
what is the smallest buffer that we can use? Motivate your answer. (3 lines)</p>
<!-- Does `Filter_vertical` offer any opportunity for data reuse?
What is the smallest buffer that we can use? (3 lines) -->
</li>
<li><p>What is the optimal order for traversing the input data (column-wise or row-wise)
with respect to FPGA on-chip memory usage? Assume that the input and output
data are stored in a BRAM. Motivate your answer. (3 lines)</p>
   <!-- ```{hint}
   We are not worrying about streaming, yet – just think about on-chip BRAM
   usage and minimization.
   ``` -->
</li>
<li><p>Create a function <code class="docutils literal notranslate"><span class="pre">Filter_vertical_HW</span></code> that is a version of <code class="docutils literal notranslate"><span class="pre">Filter_vertical_SW</span></code>
that you modified based on the insights from the previous two questions. You
don’t have to use the streams yet. Include the code in your report.</p>
   <!-- Include the code and your testbench's output in your report. -->
   <!-- ```{hint}
   Remember (from HW 1) what can go wrong when you write outside
   of the bounds of an array. Take care to make sure your array references are all in
   bounds.
   ``` -->
</li>
<li><p>Pipeline the loop body of <code class="docutils literal notranslate"><span class="pre">Filter_vertical_HW</span></code>. Write a testbench to verify
<code class="docutils literal notranslate"><span class="pre">Filter_vertical_HW</span></code>.
What is the latency(in cycles) that Vitis HLS predicts? (1 line)</p>
<!-- You can
ignore whether Vitis HLS meets the clock period or not for now. (1 line) -->
   <!-- ```{hint}
   Try to achieve latency of <130000 cycles for `Filter_vertical_HW`.
   ``` -->
</li>
</ol>
</li>
<li><p><strong>hls::stream</strong></p>
<ol class="arabic">
<li><p>Write a verification function for <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code>.
Verify that your test function works. Include the test function in your report.</p></li>
<li><p>Create a function <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code> that connects both parts of the filter together. Store
the intermediate results in a local array. Include <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code> in your report. Use
the default data movers. Also include the testbench’s output in your report.
What is the expected latency(in cycles) of <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code>?</p></li>
<li><p>We could replace the local array in <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code> with a stream. Assume that the
stream requires no resources for buffering. What impact do you expect that will
have on the resource consumption? Quantify your answer. (3 lines)</p></li>
<li><p>Replace the local array with an <code class="docutils literal notranslate"><span class="pre">hls::stream</span></code> object and insert a dataflow
pragma into <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code>. The <code class="docutils literal notranslate"><span class="pre">hls::stream</span></code> class is declared in <code class="docutils literal notranslate"><span class="pre">hls_stream.h</span></code>.
Modify the remaining functions as necessary.
Include <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code> and any other significant changes in your report.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>We are concerned with streaming now, and that could merit a
reconsideration of how we travese the data.</p>
</div>
   <!-- Note that you don’t have to inline
   Filter_horizontal_HW and Filter_vertical_HW explicitly. The tool typically
   inlines them automatically, or you can use the inline pragma to obtain the same
   result.  -->
</li>
<li><p>What is the latency of <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code> that Vitis HLS predicts? Make sure you verify your
code. (1 line)</p></li>
</ol>
</li>
<li><p><strong>Moving on HW</strong></p>
<ol class="arabic">
<li><p>Partition the <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code> in a Load-Compute-Store pattern as we did in HW6.(<a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1393-vitis-application-acceleration/Step-1-Partition-the-Code-into-a-Load-Compute-Store-Pattern">Partition the Code into a Load-Compute-Store pattern</a>)
Verify the code and include the final code in the report.</p></li>
<li><p>Export your <code class="docutils literal notranslate"><span class="pre">Filter_HW</span></code> as <code class="docutils literal notranslate"><span class="pre">.xo</span></code> file and build <code class="docutils literal notranslate"><span class="pre">.xclbin</span></code> file as we
did in HW5. Create a host code and include other functions like scale, differentiate, and compress
so that they run on ARM core. Run Filter function on FPGA. Use the same <code class="docutils literal notranslate"><span class="pre">Input.bin</span></code> as input data and
<code class="docutils literal notranslate"><span class="pre">Golden.bin</span></code> from HW3 to verify the output.
Use <code class="docutils literal notranslate"><span class="pre">O2</span></code> as the optimization level for the host code compile.
Include the host code in the report.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> and the host code we used for the previous HWs.
Collect the data before transferring to Filter kernel, and collect the data back
after the kernel computation to feed in to the next stage, compress.
You want to enable out-of-order queue to overlap communication and computation.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don’t worry too much about the performance for now. In this question, we just want you to
integrate the HW kernel with other application running on CPU.</p>
</div>
</li>
<li><p>Report the application latency to process 200 frames.
Compare it with the baseline application latency from HW3 (1 line).</p></li>
<li><p>How can you run other stages on the processor concurrently with the Filter kernel on FPGA?
What is the speedup you expect to achieve?</p></li>
</ol>
</li>
</ol>
<section id="deliverables">
<h2>Deliverables<a class="headerlink" href="#deliverables" title="Link to this heading">#</a></h2>
<p>In summary, upload the following in their respective links in canvas:</p>
<ul class="simple">
<li><p>writeup in pdf.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./hw7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">Deliverables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Department of Electrical and Systems Engineering
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 Department of Electrical and Systems Engineering at the University of Pennsylvania.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>