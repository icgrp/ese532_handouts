

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Ultra96 Setup &#8212; ESE5320 Handouts Fall 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hw3/u96v2_setup';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Setup and Walk-through" href="walk_through.html" />
    <link rel="prev" title="Collaboration" href="collaboration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/penn_engineering.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/penn_engineering.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Overview
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://www.seas.upenn.edu/~ese5320/fall2024/fall2024.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writeup_guidelines.html">Writeup Guidelines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework Assignments</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw0/index.html">Diagnostic Assessment</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw0/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw0/questions.html">Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw0/homework_submission.html">Homework Submission</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw1/index.html">HW1 – Remember C</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw1/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/walk_through.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/makefile_tutorial.html">Makefile Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/gdb_tutorial.html">GDB Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/c_refresher.html">C Refresher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/debug_app.html">Debug an Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw1/homework_submission.html">Homework Submission</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw2/index.html">HW2 – Profiling</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw2/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw2/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw2/homework_submission.html">Homework Submission</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">HW3 – Thread Parallel</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="collaboration.html">Collaboration</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">Ultra96 Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="homework_submission.html">Homework Submission</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw4/index.html">HW4 – SIMD</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw4/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw4/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw4/homework_submission.html">Homework Submission</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw5/index.html">HW5 – Accelerator</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw5/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw5/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw5/homework_submission.html">Homework Submission</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw6/index.html">HW6 – Accelerator Interface</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw6/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw6/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw6/homework_submission.html">Homework Submission</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hw7/index.html">HW7 – Restructuring C for Accelerator and Zynq Transition</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hw7/collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw7/walk_through.html">Setup and Walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hw7/homework_submission.html">Homework Submission</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/icgrp/ese532_handouts" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/icgrp/ese532_handouts/edit/master/ese532_handouts/hw3/u96v2_setup.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/icgrp/ese532_handouts/issues/new?title=Issue%20on%20page%20%2Fhw3/u96v2_setup.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/hw3/u96v2_setup.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ultra96 Setup</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-xilinx-zynq-architecture">AMD-Xilinx Zynq Architecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-setup">Environment Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-ultra96-and-host-computer">Setting up Ultra96 and Host Computer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-on-the-fpga">Run on the FPGA</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#write-the-sd-card-image">Write the SD Card Image</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-with-linux">Boot the Ultra96 (Environment - Personal Computer with Linux)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boot-the-ultra96-environment-mac">Boot the Ultra96 (Environment - Mac)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows">Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remote-ssh-via-vscode-not-recommended">Remote SSH via VSCode (not recommended)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ultra96-setup">
<h1>Ultra96 Setup<a class="headerlink" href="#ultra96-setup" title="Permalink to this heading">#</a></h1>
<section id="amd-xilinx-zynq-architecture">
<h2>AMD-Xilinx Zynq Architecture<a class="headerlink" href="#amd-xilinx-zynq-architecture" title="Permalink to this heading">#</a></h2>
<figure class="align-default" id="zynq">
<a class="reference internal image-reference" href="../_images/zynq-eg-block.png"><img alt="../_images/zynq-eg-block.png" src="../_images/zynq-eg-block.png" style="height: 550px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">AMD-Xilinx Zynq UltraScale+ MPSoC diagram</span><a class="headerlink" href="#zynq" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<!-- 
```{figure} images/topo.png
---
height: 450px
name: topo
---
An 8-core machine with 2 hyper-threads
``` 
-->
<p>Ultra96 v2 board features Xilinx
<a class="reference external" href="https://www.xilinx.com/products/silicon-devices/soc/zynq-ultrascale-mpsoc.html#productAdvantages">Zynq UltraScale+ MPSoC</a>.
Zynq UltraScale+ MPSoC is a heterogeneous SoC that consists of
Processing System (PS) and Processing Logic (PL).
PS includes the quad-core ARM Cortex A53-based APU (Application Processing Unit)
and the dual-core ARM Cortex R5-based RPU (Real-Time Processing Unit).
PL refers to FPGA hardware resources LUTs (Look-Up Tables), FFs (Flip-Flops),
Block RAMs, DSPs, etc.
In this lab, we will first run Linux on the A53, and
we will divide the computation into threads that run on different cores.</p>
<!-- {numref}`topo` shows a machine on Biglab. Some nodes in Biglab have 4 cores with
2 hyper-threads each and others have 8 cores with 1 thread each.
We will be running these threads on the Linux OS and hence, all the
heavy lifting of sharing main memory global address is taken care of
by the OS.
Because we will be running multiple threads on the Linux OS, 
all the heavy lifting of sharing main memory global address is taken care of
by the OS. -->
<!-- However, in a bare-metal system:
- we would have to map the main memory (DRAM) into the address spaces of each processor.
    Only then can the processors distribute and coordinate the work (which
    involves communicating pointers to shared memory areas and synchronization).
- in order to share data, the processors in the bare-metal system must
    agree on the location and organization of the data.
- we must make sure that the processors respect each other's private memory areas.
    We can do that in a bare-metal system by mapping private code and data of
    individual processors at different locations.
- Sharing DRAM is complicated by the fact that DRAM is cached in L1 and L2 caches.
    Data that one processor attempts to write to DRAM may not have been written to
    shared DRAM yet, but instead remain in the private L1 cache of the processor.
    When another processor reads the same memory location, it may observe an old
    value. Fortunately, 
    the ARM on the Zynq a Snoop Control Unit, which bypasses data directly between processors
    as needed to maintain a consistent view of the DRAM. Therefore, this is no concern.


Another problem that we face when we communicate via shared memory is that
the reading processor should not start reading the memory until the writing
processor has completed writing the data.  In other words, we need a form
of synchronization between the cores.  Design of synchronization functions
is a rather complex subject, which is dealt with in other courses such as
CIS 471 or CIS 505. In this assignment, we will use the APIs of `std::thread`
to accomplish synchronization between cores. We will show you exactly how to
use these APIs in the following sections, but if you would like to learn about
`std::threads`, here are some useful links:
- [Concurrency in C++](https://www.classes.cs.uchicago.edu/archive/2013/spring/12300-1/labs/lab6/)
- [C++11 threads, affinity and hyperthreading](https://eli.thegreenplace.net/2016/c11-threads-affinity-and-hyperthreading/)
- [C++ threads tutorial](https://www.bogotobogo.com/cplusplus/C11/1_C11_creating_thread.php)
- [Measuring Mutexes, Spinlocks and how Bad the Linux Scheduler Really is](https://probablydance.com/2019/12/30/measuring-mutexes-spinlocks-and-how-bad-the-linux-scheduler-really-is/)

If you prefer a book, refer to ***C++ Concurrency in Action*** by Anthony D. Williams. -->
</section>
<section id="environment-setup">
<h2>Environment Setup<a class="headerlink" href="#environment-setup" title="Permalink to this heading">#</a></h2>
<section id="setting-up-ultra96-and-host-computer">
<h3>Setting up Ultra96 and Host Computer<a class="headerlink" href="#setting-up-ultra96-and-host-computer" title="Permalink to this heading">#</a></h3>
<p>We have provided you with:</p>
<ul class="simple">
<li><p>An Ultra96 board with a power cable and a JTAG USB cable</p>
<ul>
<li><p>Please check SW3 as the Note below.
1 should be in the “off” position,
and 2 should be in the “on” position.</p></li>
</ul>
</li>
<li><p>2 USB-ethernet adapters</p></li>
<li><p>1 ethernet cable</p></li>
<li><p>1 SD card and an SD card reader</p></li>
<li><p>USB-C to USB 3.1 adaptor (for those of you who only have USB-C ports in your computer)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some of you might be receiving the boards disassembled. In that case, make sure you have set the board in SD card mode as follows:</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="../_images/sd_card_mode.jpg"><img alt="../_images/sd_card_mode.jpg" src="../_images/sd_card_mode.jpg" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">SD card mode. 1 is OFF and 2 is ON at SW3.</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>And also make sure you have properly connected the JTAG module as follows:</p>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="../_images/jtag.png"><img alt="../_images/jtag.png" src="../_images/jtag.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">JTAG module</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<blockquote>
<div><p>Be cautious with ESD protection when using this board with Ultra96. The Ultra96 has exposed pins on the UART and JTAG headers. Be careful not to touch these pins or the circuits on the Pod when plugging the boards together - <a class="reference external" href="https://www.avnet.com/opasdata/d120001/medias/docus/190/5362-PB-AES-ACC-U96-JTAG-V3b.pdf">https://www.avnet.com/opasdata/d120001/medias/docus/190/5362-PB-AES-ACC-U96-JTAG-V3b.pdf</a></p>
</div></blockquote>
</div>
<p>Your setup for this HW should look like <a class="reference internal" href="#id1"><span class="std std-numref">Fig. 6</span></a>. Note that the USB to Ethernet adapter should be plugged into the USB port closest to the corner of the board.</p>
<figure class="align-default" id="id1">
<img alt="../_images/env_setup.jpg" src="../_images/env_setup.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Development Environment</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="run-on-the-fpga">
<h3>Run on the FPGA<a class="headerlink" href="#run-on-the-fpga" title="Permalink to this heading">#</a></h3>
<section id="write-the-sd-card-image">
<h4>Write the SD Card Image<a class="headerlink" href="#write-the-sd-card-image" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>Download a sample SD card image for Ultra96 from
<a class="reference external" href="https://drive.google.com/file/d/1iJ50GLfd5ZcNvMm0A2MnOB7aEO9HInTC/view?usp=drive_link">sample SD card image</a>.</p>
<!-- - In the **Reference Designs** tab:
  - Click on the **Ultra96-V2 – Vitis PetaLinux Platform 2020+ Vector Add (Sharepoint site)** link.
  - Browse to **2020.2** -> **Vitis_PreBuilt_Example** -> **u96v2_sbc_vadd_2020_2.tar.gz**
  - Click on the download button -->
</li>
<li><p>Then, unzip the <code class="docutils literal notranslate"><span class="pre">u96v2_sbc_vadd_2020_2.tar.gz</span></code>. The .gz file contains <code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code> and <code class="docutils literal notranslate"><span class="pre">README.txt</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar<span class="w"> </span>-xvzf<span class="w"> </span>u96v2_sbc_vadd_2020_2.tar.gz
</pre></div>
</div>
</li>
<li><p>Write <code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code> to your SD card.</p>
<ul class="simple">
<li><p>In Ubuntu 20.04, you can use <code class="docutils literal notranslate"><span class="pre">Startup</span> <span class="pre">Disk</span> <span class="pre">Creator</span></code>.</p></li>
<li><p>You can also use <a class="reference external" href="https://rufus.ie/">Rufus</a> or
<a class="reference external" href="https://www.balena.io/etcher/">balenaEtcher</a>.</p></li>
</ul>
</li>
<li><p>Once you finish writing the image to the SD card, slide it into your Ultra96’s SD card slot.</p></li>
</ul>
</section>
<section id="boot-the-ultra96-environment-personal-computer-with-linux">
<h4>Boot the Ultra96 (Environment - Personal Computer with Linux)<a class="headerlink" href="#boot-the-ultra96-environment-personal-computer-with-linux" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>The instructions here are for users running Linux on their personal computers. For Windows and Mac users, skim these through, and
then go to <a class="reference internal" href="#boot-windows"><span class="std std-ref">Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)</span></a> or <a class="reference internal" href="#boot-mac"><span class="std std-ref">Boot the Ultra96 (Environment - Mac)</span></a>.</p></li>
<li><p>Make sure you have the board connected as shown in <a class="reference internal" href="#id1"><span class="std std-numref">Fig. 6</span></a>.</p></li>
<li><p>We will use two terminals on our host computer:</p>
<ul class="simple">
<li><p>the first terminal will be used to copy binaries onto the Ultra96</p></li>
<li><p>the second terminal will be used to access the serial console of the Ultra96</p></li>
</ul>
</li>
<li><p>We will now open the serial console of the Ultra96.
You can use any program like <code class="docutils literal notranslate"><span class="pre">minicom</span></code>, <code class="docutils literal notranslate"><span class="pre">gtkterm</span></code> or <code class="docutils literal notranslate"><span class="pre">PuTTY</span></code> to connect to our serial port.
We are using <code class="docutils literal notranslate"><span class="pre">PuTTY</span></code> and launch <code class="docutils literal notranslate"><span class="pre">PuTTY</span></code> by <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">putty</span></code>.
The settings are shown in <a class="reference internal" href="#putty"><span class="std std-numref">Fig. 7</span></a>. <code class="docutils literal notranslate"><span class="pre">/dev/ttyUSB1</span></code> is the port where the Ultra96 dumps all
the console output. If you are on Windows, this will be
something different, like <code class="docutils literal notranslate"><span class="pre">COM4</span></code>.</p>
<figure class="align-default" id="putty">
<img alt="../_images/putty.png" src="../_images/putty.png" />
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">PuTTY settings</span><a class="headerlink" href="#putty" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>After you have connected to the serial port, boot the board
by pressing the boot switch as shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">boot</span></code>.</p>
<figure class="align-default" id="boot">
<img alt="../_images/boot.png" src="../_images/boot.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Switch for booting Ultra96</span><a class="headerlink" href="#boot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Watch your serial console for boot messages. Following is what ours look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>�Xilinx Zynq MP First Stage Boot Loader
Release 2020.1   Oct 17 2020  -  06:29:34
NOTICE:  ATF running on XCZU3EG/silicon v4/RTL5.1 at 0xfffea000
NOTICE:  BL31: v2.2(release):v1.1-5588-g5918e656e
NOTICE:  BL31: Built : 20:07:49, Oct 17 2020
U-Boot 2020.01 (Oct 17 2020 - 20:08:47 +0000)
Model: Avnet Ultra96 Rev1
Board: Xilinx ZynqMP
DRAM:  2 GiB
.
.
.
Starting kernel ...
[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x410fd034]
[    0.000000] Linux version 5.4.0-xilinx-v2020.1 (oe-user@oe-host) (gcc version 9.2.0 (GCC)) #1 SMP Sat Oct 17 20:08:16 UTC 2020
[    0.000000] Machine model: Avnet Ultra96 Rev1
[    0.000000] earlycon: cdns0 at MMIO 0x00000000ff010000 (options &#39;115200n8&#39;)
[    0.000000] printk: bootconsole [cdns0] enabled
[    0.000000] efi: Getting EFI parameters from FDT:
[    0.000000] efi: UEFI not found.
[    0.000000] Reserved memory: created DMA memory pool at 0x000000003ed40000, size 1 MiB
[    0.000000] OF: reserved mem: initialized node rproc@3ed400000, compatible id shared-dma-pool
[    0.000000] cma: Reserved 512 MiB at 0x000000005fc00000
.
.
.
.
Starting syslogd/klogd: done
Starting tcf-agent: OK
PetaLinux 2020.1 ultra96v2-2020-1 ttyPS0
root@ultra96v2-2020-1:~# The XKEYBOARD keymap compiler (xkbcomp) reports:
&gt; Warning:          Unsupported high keycode 372 for name &lt;I372&gt; ignored
&gt;                   X11 cannot support keycodes above 255.
&gt;                   This warning only shows for the first high keycode.
Errors from xkbcomp are not fatal to the X server
D-BUS per-session daemon address is: unix:abstract=/tmp/dbus-2CuBS4BnDn,guid=63270a6bec61460191859caa5f9022fc
matchbox: Cant find a keycode for keysym 269025056
matchbox: ignoring key shortcut XF86Calendar=!$contacts
matchbox: Cant find a keycode for keysym 2809
matchbox: ignoring key shortcut telephone=!$dates
matchbox: Cant find a keycode for keysym 269025050
matchbox: ignoring key shortcut XF86Start=!matchbox-remote -desktop
dbus-daemon[641]: Activating service name=&#39;org.a11y.atspi.Registry&#39; requested by &#39;:1.0&#39; (uid=0 pid=636 comm=&quot;matchbox-desktop &quot;)
dbus-daemon[641]: Successfully activated service &#39;org.a11y.atspi.Registry&#39;
SpiRegistry daemon is running with well-known name - org.a11y.atspi.Registry
[settings daemon] Forking. run with -n to prevent fork
</pre></div>
</div>
</li>
<li><p>Note that near the end some messages spill, so just press Enter couple of times, and you see that you need to login. Login as <code class="docutils literal notranslate"><span class="pre">root</span></code> with Password: <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@u96v2-sbc-base-2020-2:~#
</pre></div>
</div>
</li>
<li><p>We will now enable ethernet connection between our Ultra96 and
the host computer, such that we can copy files between
the devices. Issue the following command in the serial console:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig<span class="w"> </span>eth0<span class="w"> </span><span class="m">10</span>.10.7.1<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.0.0.0
</pre></div>
</div>
</li>
<li><p>Now in your second console <strong>on the host computer</strong>, first
find out the name that has been assigned to the USB-ethernet
device by issuing <code class="docutils literal notranslate"><span class="pre">ifconfig</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enx000ec6c4b500</span><span class="p">:</span> <span class="n">flags</span><span class="o">=</span><span class="mi">4163</span><span class="o">&lt;</span><span class="n">UP</span><span class="p">,</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">RUNNING</span><span class="p">,</span><span class="n">MULTICAST</span><span class="o">&gt;</span>  <span class="n">mtu</span> <span class="mi">1500</span>
        <span class="n">inet</span> <span class="mf">10.10.7.2</span>  <span class="n">netmask</span> <span class="mf">255.0.0.0</span>  <span class="n">broadcast</span> <span class="mf">10.255.255.255</span>
        <span class="n">ether</span> <span class="mi">00</span><span class="p">:</span><span class="mi">0</span><span class="n">e</span><span class="p">:</span><span class="n">c6</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="n">b5</span><span class="p">:</span><span class="mi">00</span>  <span class="n">txqueuelen</span> <span class="mi">1000</span>  <span class="p">(</span><span class="n">Ethernet</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">packets</span> <span class="mi">213</span>  <span class="nb">bytes</span> <span class="mi">32750</span> <span class="p">(</span><span class="mf">32.7</span> <span class="n">KB</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span>  <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">frame</span> <span class="mi">0</span>
        <span class="n">TX</span> <span class="n">packets</span> <span class="mi">249</span>  <span class="nb">bytes</span> <span class="mi">25958</span> <span class="p">(</span><span class="mf">25.9</span> <span class="n">KB</span><span class="p">)</span>
        <span class="n">TX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span> <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">carrier</span> <span class="mi">0</span>  <span class="n">collisions</span> <span class="mi">0</span>
<span class="n">lo</span><span class="p">:</span> <span class="n">flags</span><span class="o">=</span><span class="mi">73</span><span class="o">&lt;</span><span class="n">UP</span><span class="p">,</span><span class="n">LOOPBACK</span><span class="p">,</span><span class="n">RUNNING</span><span class="o">&gt;</span>  <span class="n">mtu</span> <span class="mi">65536</span>
        <span class="n">inet</span> <span class="mf">127.0.0.1</span>  <span class="n">netmask</span> <span class="mf">255.0.0.0</span>
        <span class="n">inet6</span> <span class="p">::</span><span class="mi">1</span>  <span class="n">prefixlen</span> <span class="mi">128</span>  <span class="n">scopeid</span> <span class="mh">0x10</span><span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
        <span class="n">loop</span>  <span class="n">txqueuelen</span> <span class="mi">1000</span>  <span class="p">(</span><span class="n">Local</span> <span class="n">Loopback</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">packets</span> <span class="mi">570887</span>  <span class="nb">bytes</span> <span class="mi">920673672</span> <span class="p">(</span><span class="mf">920.6</span> <span class="n">MB</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span>  <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">frame</span> <span class="mi">0</span>
        <span class="n">TX</span> <span class="n">packets</span> <span class="mi">570887</span>  <span class="nb">bytes</span> <span class="mi">920673672</span> <span class="p">(</span><span class="mf">920.6</span> <span class="n">MB</span><span class="p">)</span>
        <span class="n">TX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span> <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">carrier</span> <span class="mi">0</span>  <span class="n">collisions</span> <span class="mi">0</span>
</pre></div>
</div>
<p>In our case, the USB-ethernet device is <code class="docutils literal notranslate"><span class="pre">enx000ec6c4b500</span></code>.
Now issue the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ifconfig</span> <span class="n">enx000ec6c4b500</span> <span class="mf">10.10.7.2</span> <span class="n">netmask</span> <span class="mf">255.0.0.0</span>
</pre></div>
</div>
</li>
<li><p>We have now assigned IP <code class="docutils literal notranslate"><span class="pre">10.10.7.1</span></code> to our Ultra96 and IP <code class="docutils literal notranslate"><span class="pre">10.10.7.2</span></code> to our USB ethernet device connected to our host computer.
You can test the connection by doing <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">10.10.7.2</span></code> from the Ultra96 serial console, and doing <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">10.10.7.1</span></code> from the host
computer.</p></li>
<li><p>Unfortunately, currently every time you boot your Ultra96, you will have to login via serial and configure the IP address, before you can connect via ssh. To fix this, create a new file <strong>on your host computer</strong> <code class="docutils literal notranslate"><span class="pre">.profile</span></code> (make sure you don’t do this in your home directory, or else you may overwrite an existing one). In <code class="docutils literal notranslate"><span class="pre">.profile</span></code>, add the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig<span class="w"> </span>eth0<span class="w"> </span><span class="m">10</span>.10.7.1<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.0.0.0

<span class="nb">alias</span><span class="w"> </span><span class="nv">ls</span><span class="o">=</span><span class="s2">&quot;ls --color&quot;</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">ll</span><span class="o">=</span><span class="s2">&quot;ls -laF --color&quot;</span>
</pre></div>
</div>
<p>Then create another file (also not in your home directory), called <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, and add the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>.profile
</pre></div>
</div>
<p>Next, copy these files over to the Ultra96:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scp<span class="w"> </span>.profile<span class="w"> </span>.bashrc<span class="w"> </span>root@10.10.7.1:/home/root/
</pre></div>
</div>
<p>Now when the Ultra96 boots, you should be able to connect directly over ssh without having to configure the board via serial.</p>
</li>
</ul>
</section>
<section id="boot-the-ultra96-environment-mac">
<span id="boot-mac"></span><h4>Boot the Ultra96 (Environment - Mac)<a class="headerlink" href="#boot-the-ultra96-environment-mac" title="Permalink to this heading">#</a></h4>
<p>First install the USB to Ethernet driver from <a class="reference external" href="https://www.asix.com.tw/en/product/USBEthernet/Super-Speed_USB_Ethernet/AX88179">here</a>. Then install this serial terminal from <a class="reference external" href="https://www.macupdate.com/app/mac/31352/coolterm">here</a>.</p>
<ul>
<li><p>Make sure you have the board connected as shown in <a class="reference internal" href="#id1"><span class="std std-numref">Fig. 6</span></a>.</p></li>
<li><p>We will use two terminals on our host computer:</p>
<ul class="simple">
<li><p>the first terminal will be used to copy binaries onto the Ultra96</p></li>
<li><p>the second terminal will be used to access the serial console of the Ultra96</p></li>
</ul>
</li>
<li><p>We will now open the serial console of the Ultra96. Open CoolTerm and click <code class="docutils literal notranslate"><span class="pre">options</span></code>. Then Under <code class="docutils literal notranslate"><span class="pre">Serial</span> <span class="pre">Port</span></code> choose <code class="docutils literal notranslate"><span class="pre">usbserial-1234_oj11</span></code>. Set the baudrate to 115200. Then under Data Handling, select <code class="docutils literal notranslate"><span class="pre">Handle</span> <span class="pre">BS</span> <span class="pre">and</span> <span class="pre">DEL</span> <span class="pre">Characters</span></code>. Then press okay. Then click <code class="docutils literal notranslate"><span class="pre">Connect</span></code> to open up the port.</p></li>
<li><p>After you have connected to the serial port, boot the board
by pressing the boot switch as shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">boot</span></code>.</p>
<figure class="align-default" id="id2">
<img alt="../_images/boot.png" src="../_images/boot.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Switch for booting Ultra96</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Watch your serial console for boot messages. Following is what ours look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>�Xilinx Zynq MP First Stage Boot Loader
Release 2020.1   Oct 17 2020  -  06:29:34
NOTICE:  ATF running on XCZU3EG/silicon v4/RTL5.1 at 0xfffea000
NOTICE:  BL31: v2.2(release):v1.1-5588-g5918e656e
NOTICE:  BL31: Built : 20:07:49, Oct 17 2020
U-Boot 2020.01 (Oct 17 2020 - 20:08:47 +0000)
Model: Avnet Ultra96 Rev1
Board: Xilinx ZynqMP
DRAM:  2 GiB
.
.
.
Starting kernel ...
[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x410fd034]
[    0.000000] Linux version 5.4.0-xilinx-v2020.1 (oe-user@oe-host) (gcc version 9.2.0 (GCC)) #1 SMP Sat Oct 17 20:08:16 UTC 2020
[    0.000000] Machine model: Avnet Ultra96 Rev1
[    0.000000] earlycon: cdns0 at MMIO 0x00000000ff010000 (options &#39;115200n8&#39;)
[    0.000000] printk: bootconsole [cdns0] enabled
[    0.000000] efi: Getting EFI parameters from FDT:
[    0.000000] efi: UEFI not found.
[    0.000000] Reserved memory: created DMA memory pool at 0x000000003ed40000, size 1 MiB
[    0.000000] OF: reserved mem: initialized node rproc@3ed400000, compatible id shared-dma-pool
[    0.000000] cma: Reserved 512 MiB at 0x000000005fc00000
.
.
.
.
Starting syslogd/klogd: done
Starting tcf-agent: OK
PetaLinux 2020.1 ultra96v2-2020-1 ttyPS0
root@ultra96v2-2020-1:~# The XKEYBOARD keymap compiler (xkbcomp) reports:
&gt; Warning:          Unsupported high keycode 372 for name &lt;I372&gt; ignored
&gt;                   X11 cannot support keycodes above 255.
&gt;                   This warning only shows for the first high keycode.
Errors from xkbcomp are not fatal to the X server
D-BUS per-session daemon address is: unix:abstract=/tmp/dbus-2CuBS4BnDn,guid=63270a6bec61460191859caa5f9022fc
matchbox: Cant find a keycode for keysym 269025056
matchbox: ignoring key shortcut XF86Calendar=!$contacts
matchbox: Cant find a keycode for keysym 2809
matchbox: ignoring key shortcut telephone=!$dates
matchbox: Cant find a keycode for keysym 269025050
matchbox: ignoring key shortcut XF86Start=!matchbox-remote -desktop
dbus-daemon[641]: Activating service name=&#39;org.a11y.atspi.Registry&#39; requested by &#39;:1.0&#39; (uid=0 pid=636 comm=&quot;matchbox-desktop &quot;)
dbus-daemon[641]: Successfully activated service &#39;org.a11y.atspi.Registry&#39;
SpiRegistry daemon is running with well-known name - org.a11y.atspi.Registry
[settings daemon] Forking. run with -n to prevent fork
</pre></div>
</div>
</li>
<li><p>Note that near the end some messages spill, so just press Enter couple of times, and you see that you need to login. Login as <code class="docutils literal notranslate"><span class="pre">root</span></code> with Password: <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@u96v2-sbc-base-2020-2:~#
</pre></div>
</div>
</li>
<li><p>We will now enable ethernet connection between our Ultra96 and
the host computer, such that we can copy files between
the devices. Issue the following command in the serial console:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig<span class="w"> </span>eth0<span class="w"> </span><span class="m">10</span>.10.7.1<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.0.0.0
</pre></div>
</div>
</li>
<li><p>Now on your Mac, open up SystemPreferences-&gt;Network, and then you should see AX88179 show up in the connections box. Click it and set the IP address to 10.10.7.2 and the subnet mask to 255.0.0.0</p></li>
<li><p>We have now assigned IP <code class="docutils literal notranslate"><span class="pre">10.10.7.1</span></code> to our Ultra96 and IP <code class="docutils literal notranslate"><span class="pre">10.10.7.2</span></code> to our USB ethernet device connected to our host computer.
You can test the connection by doing <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">10.10.7.2</span></code> from the Ultra96 serial console, and doing <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">10.10.7.1</span></code> from the host
computer.</p></li>
<li><p>Unfortunately, as it stands, every time you boot your Ultra96, you will have to login via serial and configure the IP address, before you can connect via ssh. To fix this, create a new file <strong>on your host computer</strong> <code class="docutils literal notranslate"><span class="pre">.profile</span></code> (make sure you don’t do this in your home directory, or else you may overwrite an existing one). In <code class="docutils literal notranslate"><span class="pre">.profile</span></code>, add the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig<span class="w"> </span>eth0<span class="w"> </span><span class="m">10</span>.10.7.1<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.0.0.0

<span class="nb">alias</span><span class="w"> </span><span class="nv">ls</span><span class="o">=</span><span class="s2">&quot;ls --color&quot;</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">ll</span><span class="o">=</span><span class="s2">&quot;ls -laF --color&quot;</span>
</pre></div>
</div>
<p>Then create another file (also not in your home directory), called <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, and add the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>.profile
</pre></div>
</div>
<p>Next, copy these files over to the Ultra96:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scp<span class="w"> </span>.profile<span class="w"> </span>.bashrc<span class="w"> </span>root@10.10.7.1:/home/root/
</pre></div>
</div>
<p>Now when the Ultra96 boots, you should be able to connect directly over ssh without having to configure the board via serial.</p>
</li>
</ul>
</section>
<section id="boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows">
<span id="boot-windows"></span><h4>Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)<a class="headerlink" href="#boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows" title="Permalink to this heading">#</a></h4>
<ul>
<li><p>Connect your ultra96 jtag usb to your computer. Also connect the ethernet-usb to ultra96 and the computer. Go to device managers and note down the serial port of the usb. In the example case, it’s COM4.</p>
<figure class="align-default" id="id5">
<img alt="../_images/win_eth_0.jpg" src="../_images/win_eth_0.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Find the port</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Download and install MobaXterm from <a class="reference external" href="https://download.mobatek.net/2042020100805218/MobaXterm_Installer_v20.4.zip">here</a>. In Detkin/Ketterer machines, use the portable version since you don’t have a permission to install the software.</p></li>
<li><p>Start MobaXterm. Click <em><strong>Session</strong></em> in the left top corner and select <em><strong>Serial</strong></em>.
Set the serial port as the one you found in the previous step and bps. In the example case,
it’s COM4 and 115200. Click <em><strong>OK</strong></em>.</p></li>
<li><p>Boot the board by pressing the boot switch as shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">boot</span></code>.</p></li>
<li><p>Note that near the end some messages spill, so just press Enter couple of times, and you see that you need to login. Login as <code class="docutils literal notranslate"><span class="pre">root</span></code> with Password: <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@u96v2</span><span class="o">-</span><span class="n">sbc</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mi">2020</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">~</span><span class="c1">#</span>
</pre></div>
</div>
</li>
<li><p>Click plus sign to open up the local machine’s session(new tab).
Type <code class="docutils literal notranslate"><span class="pre">ifconfig</span></code> and find out the ip address and netmask assigned to the USB-ethernet device. Following is the example:</p>
<figure class="align-default" id="id6">
<img alt="../_images/win_eth_1.jpg" src="../_images/win_eth_1.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">ifconfig to find out your local machine’s ip</span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Assign your Ultra96 an ip address on the same subnet as the USB-ethernet, e.g. from the
previous step, the ip address of the local machine is <code class="docutils literal notranslate"><span class="pre">169.254.123.23</span></code> and netmask is
<code class="docutils literal notranslate"><span class="pre">255.255.0.0</span></code>. So, let’s assign the ultra96 to a ip of <code class="docutils literal notranslate"><span class="pre">169.254.123.24</span></code>(note that
this is 24!) as follows:</p>
<figure class="align-default" id="id7">
<img alt="../_images/win_eth_2.jpg" src="../_images/win_eth_2.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Connect you machine and Ultra96</span><a class="headerlink" href="#id7" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Your devices are now connected. Go to the local machine’s tab and ssh into the Ultra96:</p>
<figure class="align-default" id="id8">
<img alt="../_images/win_eth_3.jpg" src="../_images/win_eth_3.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">ssh in to the Ultra96 and transfer files</span><a class="headerlink" href="#id8" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>You can view the files of the Ultra96 on the left hand side.
You can easily drag and drop files from/to the local machine to/from Ultra96.</p></li>
<li><p>Unfortunately, currently every time you boot your Ultra96, you will have to login via serial and configure the IP address, before you can connect via ssh. To fix this, create a new file <strong>on your host computer</strong> <code class="docutils literal notranslate"><span class="pre">.profile</span></code> (make sure you don’t do this in your home directory, or else you may overwrite an existing one). In <code class="docutils literal notranslate"><span class="pre">.profile</span></code>, add the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig<span class="w"> </span>eth0<span class="w"> </span>put-your-ip-address-here<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.0.0

<span class="nb">alias</span><span class="w"> </span><span class="nv">ls</span><span class="o">=</span><span class="s2">&quot;ls --color&quot;</span>
<span class="nb">alias</span><span class="w"> </span><span class="nv">ll</span><span class="o">=</span><span class="s2">&quot;ls -laF --color&quot;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">put-your-ip-address-here</span></code> is the ip you set in the previous step (in the example it was <code class="docutils literal notranslate"><span class="pre">169.254.123.24</span></code>).
Then create another file (also not in your home directory), called <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, and add the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>.profile
</pre></div>
</div>
<p>Next, drag and drop these files over to the Ultra96 in /home/root/. Now when the Ultra96 boots, you should be able to connect directly over ssh without having to configure the board via serial.</p>
</li>
</ul>
</section>
</section>
<section id="remote-ssh-via-vscode-not-recommended">
<h3>Remote SSH via VSCode (not recommended)<a class="headerlink" href="#remote-ssh-via-vscode-not-recommended" title="Permalink to this heading">#</a></h3>
<p>Using Remote SSH in VSCode to write code directly on your board can be convenient. However, Remote SSH installs a server on the board during tunnel setup, which consumes significant space. Given the limited storage capacity of SD cards you will get, this can lead to space constraints when you need additional files or further compilation. To avoid this, it is recommended to develop locally on your host computer and ‘scp’ files to the board.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./hw3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="collaboration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Collaboration</p>
      </div>
    </a>
    <a class="right-next"
       href="walk_through.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Setup and Walk-through</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-xilinx-zynq-architecture">AMD-Xilinx Zynq Architecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-setup">Environment Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-ultra96-and-host-computer">Setting up Ultra96 and Host Computer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-on-the-fpga">Run on the FPGA</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#write-the-sd-card-image">Write the SD Card Image</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-with-linux">Boot the Ultra96 (Environment - Personal Computer with Linux)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boot-the-ultra96-environment-mac">Boot the Ultra96 (Environment - Mac)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows">Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remote-ssh-via-vscode-not-recommended">Remote SSH via VSCode (not recommended)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Department of Electrical and Systems Engineering
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024 Department of Electrical and Systems Engineering at the University of Pennsylvania.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>