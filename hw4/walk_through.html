
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.2. Setup and Walk-through &#8212; ESE5320 Handouts Fall 2022</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.3. Homework Submission" href="homework_submission.html" />
    <link rel="prev" title="4.1. Collaboration" href="collaboration.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/penn_engineering.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ESE5320 Handouts Fall 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Overview
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://www.seas.upenn.edu/~ese532/fall2021/fall2021.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../writeup_guidelines.html">
   Writeup Guidelines
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Homework Assignments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../hw1/index.html">
   1. Remember C
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw1/collaboration.html">
     1.1. Collaboration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw1/walk_through.html">
     1.2. Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw1/makefile_tutorial.html">
     1.3. Makefile Tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw1/gdb_tutorial.html">
     1.4. GDB Tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw1/c_refresher.html">
     1.5. C Refresher
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw1/debug_app.html">
     1.6. Debug an Application
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw1/homework_submission.html">
     1.7. Homework Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../hw2/index.html">
   2. Profiling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw2/collaboration.html">
     2.1. Collaboration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw2/walk_through.html">
     2.2. Setup and Walk-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw2/homework_submission.html">
     2.3. Homework Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../hw3/index.html">
   3. Thread Parallel
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw3/collaboration.html">
     3.1. Collaboration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw3/walk_through.html">
     3.2. Setup and Walk-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw3/homework_submission.html">
     3.3. Homework Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   4. SIMD
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="collaboration.html">
     4.1. Collaboration
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.2. Setup and Walk-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="homework_submission.html">
     4.3. Homework Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../hw5/index.html">
   5. Accelerator
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw5/collaboration.html">
     5.1. Collaboration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw5/walk_through.html">
     5.2. Setup and Walk-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw5/homework_submission.html">
     5.3. Homework Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../hw6/index.html">
   6. Accelerator Interface
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw6/collaboration.html">
     6.1. Collaboration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw6/walk_through.html">
     6.2. Setup and Walk-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw6/homework_submission.html">
     6.3. Homework Submission
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../hw7/index.html">
   7. Restructuring C for Accelerator and Zynq Transition
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw7/collaboration.html">
     7.1. Collaboration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw7/walk_through.html">
     7.2. Setup and Walk-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../hw7/homework_submission.html">
     7.3. Homework Submission
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/icgrp/ese532_handouts"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/icgrp/ese532_handouts/issues/new?title=Issue%20on%20page%20%2Fhw4/walk_through.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/icgrp/ese532_handouts/edit/master/ese532_handouts/hw4/walk_through.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/hw4/walk_through.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectorization">
   4.2.1. Vectorization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#obtaining-the-code">
   4.2.2. Obtaining the Code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#environment-setup">
   4.2.3. Environment Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-ultra96-and-host-computer">
     4.2.3.1. Setting up Ultra96 and Host Computer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-on-the-fpga">
     4.2.3.2. Run on the FPGA
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#write-the-sd-card-image">
       4.2.3.2.1. Write the SD Card Image
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-with-linux">
       4.2.3.2.2. Boot the Ultra96 (Environment - Personal Computer with Linux)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows">
       4.2.3.2.3. Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-code">
   4.2.4. Running the Code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-neon">
   4.2.5. Working with NEON
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basics">
     4.2.5.1. Basics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-with-neon-intrinsics">
     4.2.5.2. Coding with NEON Intrinsics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optimization">
     4.2.5.3. Optimization:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-resources">
     4.2.5.4. More Resources:
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Setup and Walk-through</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectorization">
   4.2.1. Vectorization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#obtaining-the-code">
   4.2.2. Obtaining the Code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#environment-setup">
   4.2.3. Environment Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-ultra96-and-host-computer">
     4.2.3.1. Setting up Ultra96 and Host Computer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-on-the-fpga">
     4.2.3.2. Run on the FPGA
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#write-the-sd-card-image">
       4.2.3.2.1. Write the SD Card Image
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-with-linux">
       4.2.3.2.2. Boot the Ultra96 (Environment - Personal Computer with Linux)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows">
       4.2.3.2.3. Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-code">
   4.2.4. Running the Code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-neon">
   4.2.5. Working with NEON
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basics">
     4.2.5.1. Basics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-with-neon-intrinsics">
     4.2.5.2. Coding with NEON Intrinsics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optimization">
     4.2.5.3. Optimization:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-resources">
     4.2.5.4. More Resources:
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="setup-and-walk-through">
<h1><span class="section-number">4.2. </span>Setup and Walk-through<a class="headerlink" href="#setup-and-walk-through" title="Permalink to this headline">#</a></h1>
<style type="text/css">
    .table { margin-left:auto; margin-right:auto;}
    .table { width: 70%; }
    th { background-color: #4CAF50;color: white;height:50px;text-align: center; }
    td {height:50px;text-align: center;}
    tr:nth-child(even) {background-color: #f2f2f2;}
</style>
<section id="vectorization">
<h2><span class="section-number">4.2.1. </span>Vectorization<a class="headerlink" href="#vectorization" title="Permalink to this headline">#</a></h2>
<p>We will divide the computation into vectors that run on
the NEON units in our ARM cores.
<a class="reference internal" href="#cortex-a53"><span class="std std-numref">Fig. 4.1</span></a> shows the high level block diagram of
the ARM core in Ultra96 board.</p>
<figure class="align-default" id="cortex-a53">
<img alt="../_images/cortex-a53.png" src="../_images/cortex-a53.png" />
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">ARM Cortex A-53 Overview. Source: <a class="reference external" href="https://www.anandtech.com/show/7591/answered-by-the-experts-arms-cortex-a53-lead-architect-peter-greenhalgh">ANANDTECH</a></span><a class="headerlink" href="#cortex-a53" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The Ultra96 boards have ARM Cortex A-53 cores. It’s a
2-way decode, in-order core with one 64-bit NEON SIMD unit,
as shown in <a class="reference internal" href="#arm-core-table"><span class="std std-numref">Table 4.1</span></a>.</p>
<table class="table" id="arm-core-table">
<caption><span class="caption-number">Table 4.1 </span><span class="caption-text">ARM Core, Source: <a class="reference external" href="https://www.anandtech.com/show/8718/the-samsung-galaxy-note-4-exynos-review/3">A-53</a></span><a class="headerlink" href="#arm-core-table" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Cortex A-53</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ARM ISA</p></td>
<td><p>ARMv8 (32/64-bit)</p></td>
</tr>
<tr class="row-odd"><td><p>Decoder Width</p></td>
<td><p>2 micro-ops</p></td>
</tr>
<tr class="row-even"><td><p>Maximum Pipeline Length</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>Integer Add</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Integer Mul</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Load/Store Units</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Branch Units</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>FP/NEON ALUs</p></td>
<td><p>1x64-bit</p></td>
</tr>
<tr class="row-even"><td><p>L1 Cache</p></td>
<td><p>8KB-64KB I$ + 8KB-64KB D$</p></td>
</tr>
<tr class="row-odd"><td><p>L2 Cache</p></td>
<td><p>128KB - 2MB (Optional)</p></td>
</tr>
</tbody>
</table>
<p>We will use the NEON Intrinsics API to program the NEON
Units in our cores. An intrinsic behaves syntactically like a function,
but the compiler translates it to a specific instruction that is inlined
in the code. In the following sections, we will guide you through
reading the NEON Programmer’s guide and learning to use these APIs.</p>
</section>
<section id="obtaining-the-code">
<h2><span class="section-number">4.2.2. </span>Obtaining the Code<a class="headerlink" href="#obtaining-the-code" title="Permalink to this headline">#</a></h2>
<p>In the previous homework, we dealt with a streaming application that
compressed a video stream, and explored how to implement coarse-grain data-level parallelism
and pipeline parallelism using <code class="docutils literal notranslate"><span class="pre">std::threads</span></code> to speedup the application. For this homework,
we will use the same application and implement fine-grain, data-level
parallelism on a vector architecture;  we will explore both auto
vectorization with the compiler and hand-crafted NEON vector intrinsics.</p>
<ul>
<li><p>On you local machine, clone the <code class="docutils literal notranslate"><span class="pre">ese532_code</span></code>
repository using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">icgrp</span><span class="o">/</span><span class="n">ese532_code</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>If you already have it cloned, pull in the latest changes
using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">ese532_code</span><span class="o">/</span>
<span class="n">git</span> <span class="n">pull</span> <span class="n">origin</span> <span class="n">master</span>
</pre></div>
</div>
<p>The code you will use for <a class="reference internal" href="homework_submission.html"><span class="doc std std-doc">homework submission</span></a>
is in the <code class="docutils literal notranslate"><span class="pre">hw4</span></code> directory. The directory structure looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hw4</span><span class="o">/</span>
    <span class="n">assignment</span><span class="o">/</span>
        <span class="n">Makefile</span>
        <span class="n">common</span><span class="o">/</span>
            <span class="n">App</span><span class="o">.</span><span class="n">h</span>
            <span class="n">Constants</span><span class="o">.</span><span class="n">h</span>
            <span class="n">Stopwatch</span><span class="o">.</span><span class="n">h</span>
            <span class="n">Utilities</span><span class="o">.</span><span class="n">h</span>
            <span class="n">Utilities</span><span class="o">.</span><span class="n">cpp</span>
        <span class="n">src</span><span class="o">/</span>
            <span class="n">App</span><span class="o">.</span><span class="n">cpp</span>
            <span class="n">Compress</span><span class="o">.</span><span class="n">cpp</span>
            <span class="n">Differentiate</span><span class="o">.</span><span class="n">cpp</span>
            <span class="n">Filter</span><span class="o">.</span><span class="n">cpp</span>
            <span class="n">Scale</span><span class="o">.</span><span class="n">cpp</span>
        <span class="n">neon_example</span><span class="o">/</span>
            <span class="n">Example</span><span class="o">.</span><span class="n">cpp</span>
    <span class="n">data</span><span class="o">/</span>
        <span class="n">Input</span><span class="o">.</span><span class="n">bin</span>
        <span class="n">Golden</span><span class="o">.</span><span class="n">bin</span>
</pre></div>
</div>
</li>
<li><p>We will now copy the <code class="docutils literal notranslate"><span class="pre">hw4</span></code> directory into the Ultra96.</p></li>
</ul>
</section>
<section id="environment-setup">
<h2><span class="section-number">4.2.3. </span>Environment Setup<a class="headerlink" href="#environment-setup" title="Permalink to this headline">#</a></h2>
<section id="setting-up-ultra96-and-host-computer">
<h3><span class="section-number">4.2.3.1. </span>Setting up Ultra96 and Host Computer<a class="headerlink" href="#setting-up-ultra96-and-host-computer" title="Permalink to this headline">#</a></h3>
<p>We have provided you with:</p>
<ul class="simple">
<li><p>An Ultra96 board with a power cable and a JTAG USB cable</p>
<ul>
<li><p>Please check SW3 as the Note below.
1 shuold be in the “off” position,
and 2 should be in the “on” position.</p></li>
</ul>
</li>
<li><p>2 USB-ethernet adapters</p></li>
<li><p>1 ethernet cable</p></li>
<li><p>1 SD card and an SD card reader</p></li>
<li><p>USB-C to USB 3.1 adaptor (for those of you who only have USB-C ports in your computer)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some of you might be receiving the boards disassembled. In that case, make sure you have set the board in SD card mode as follows:</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/sd_card_mode.jpg"><img alt="../_images/sd_card_mode.jpg" src="../_images/sd_card_mode.jpg" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.2 </span><span class="caption-text">SD card mode. 1 is OFF and 2 is ON at SW3.</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>And also make sure you have properly connected the JTAG module as follows:</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/jtag.png"><img alt="../_images/jtag.png" src="../_images/jtag.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.3 </span><span class="caption-text">JTAG module</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<blockquote>
<div><p>Be cautious with ESD protection when using this board with Ultra96. The Ultra96 has exposed pins on the UART and JTAG headers. Be careful not to touch these pins or the circuits on the Pod when plugging the boards together - <a class="reference external" href="http://www.zedboard.org/product/ultra96-usb-jtaguart-pod">http://www.zedboard.org/product/ultra96-usb-jtaguart-pod</a></p>
</div></blockquote>
</div>
<p>Your setup for this HW should look like <a class="reference internal" href="#ultra96-setup"><span class="std std-numref">Fig. 4.4</span></a>.</p>
<figure class="align-default" id="ultra96-setup">
<img alt="../_images/env_setup.jpg" src="../_images/env_setup.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 4.4 </span><span class="caption-text">Development Environment</span><a class="headerlink" href="#ultra96-setup" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="run-on-the-fpga">
<h3><span class="section-number">4.2.3.2. </span>Run on the FPGA<a class="headerlink" href="#run-on-the-fpga" title="Permalink to this headline">#</a></h3>
<section id="write-the-sd-card-image">
<h4><span class="section-number">4.2.3.2.1. </span>Write the SD Card Image<a class="headerlink" href="#write-the-sd-card-image" title="Permalink to this headline">#</a></h4>
<ul>
<li><p>Download a sample SD card image for Ultra96 from
<a class="reference external" href="https://www.element14.com/community/docs/DOC-95649/l/ultra96-v2">here</a>.</p>
<ul class="simple">
<li><p>In the <strong>Reference Designs</strong> tab:</p>
<ul>
<li><p>Click on the <strong>Ultra96-V2 – Vitis PetaLinux Platform 2020+ Vector Add (Sharepoint site)</strong> link.</p></li>
<li><p>Browse to <strong>2020.2</strong> -&gt; <strong>Vitis_PreBuilt_Example</strong> -&gt; <strong>u96v2_sbc_vadd_2020_2.tar.gz</strong></p></li>
<li><p>Click on the download button</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Then, unzip the file. The .gz file contains <code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code> and <code class="docutils literal notranslate"><span class="pre">README.txt</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="o">-</span><span class="n">xvzf</span> <span class="n">u96v2_sbc_vadd_2020_2</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</li>
<li><p>Write <code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code> to your SD card.</p>
<ul class="simple">
<li><p>In Ubuntu 20.04, you can use <code class="docutils literal notranslate"><span class="pre">Startup</span> <span class="pre">Disk</span> <span class="pre">Creator</span></code>.</p></li>
<li><p>You can also use <a class="reference external" href="https://rufus.ie/">Rufus</a> or
<a class="reference external" href="https://www.balena.io/etcher/">balenaEtcher</a>.</p></li>
</ul>
</li>
<li><p>Once you finish writing the image to the SD card, slide it into your Ultra96’s SD card slot.</p></li>
</ul>
</section>
<section id="boot-the-ultra96-environment-personal-computer-with-linux">
<h4><span class="section-number">4.2.3.2.2. </span>Boot the Ultra96 (Environment - Personal Computer with Linux)<a class="headerlink" href="#boot-the-ultra96-environment-personal-computer-with-linux" title="Permalink to this headline">#</a></h4>
<ul>
<li><p>The instructions here are for users running Linux on their personal computers. For Windows users, skim these through, and
go to <a class="reference internal" href="#boot-windows"><span class="std std-ref">Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)</span></a>.</p></li>
<li><p>Make sure you have the board connected as shown in <a class="reference internal" href="#ultra96-setup"><span class="std std-numref">Fig. 4.4</span></a>.</p></li>
<li><p>We will use two terminals on our host computer:</p>
<ul class="simple">
<li><p>the first terminal will be used to copy binaries into the Ultra96</p></li>
<li><p>the second terminal will be used to access the serial console of the Ultra96</p></li>
</ul>
</li>
<li><p>We will now open the serial console of the Ultra96. You can use any program like <code class="docutils literal notranslate"><span class="pre">minicom</span></code>, <code class="docutils literal notranslate"><span class="pre">gtkterm</span></code> or <code class="docutils literal notranslate"><span class="pre">PuTTY</span></code> to connect to our serial port. We are using <code class="docutils literal notranslate"><span class="pre">minicom</span></code> and following is the command we use for connecting to the serial port:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB1</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">/dev/ttyUSB1</span></code> is the port where the Ultra96 dumps all
the console output. If you are on Windows, this will be
something different, like <code class="docutils literal notranslate"><span class="pre">COM4</span></code>. When you want to get out
of <code class="docutils literal notranslate"><span class="pre">minicom</span></code>, use <code class="docutils literal notranslate"><span class="pre">CTRL-A</span> <span class="pre">Z</span> <span class="pre">q</span></code></p>
</li>
<li><p>After you have connected to the serial port, boot the board
by pressing the boot switch as shown in <a class="reference internal" href="../hw5/walk_through.html#boot"><span class="std std-numref">Fig. 5.8</span></a>.</p>
<figure class="align-default" id="boot">
<img alt="../_images/boot.png" src="../_images/boot.png" />
<figcaption>
<p><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Switch for booting Ultra96</span><a class="headerlink" href="#boot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Watch your serial console for boot messages. Following is what ours look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>�Xilinx Zynq MP First Stage Boot Loader
Release 2020.1   Oct 17 2020  -  06:29:34
NOTICE:  ATF running on XCZU3EG/silicon v4/RTL5.1 at 0xfffea000
NOTICE:  BL31: v2.2(release):v1.1-5588-g5918e656e
NOTICE:  BL31: Built : 20:07:49, Oct 17 2020
U-Boot 2020.01 (Oct 17 2020 - 20:08:47 +0000)
Model: Avnet Ultra96 Rev1
Board: Xilinx ZynqMP
DRAM:  2 GiB
.
.
.
Starting kernel ...
[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x410fd034]
[    0.000000] Linux version 5.4.0-xilinx-v2020.1 (oe-user@oe-host) (gcc version 9.2.0 (GCC)) #1 SMP Sat Oct 17 20:08:16 UTC 2020
[    0.000000] Machine model: Avnet Ultra96 Rev1
[    0.000000] earlycon: cdns0 at MMIO 0x00000000ff010000 (options &#39;115200n8&#39;)
[    0.000000] printk: bootconsole [cdns0] enabled
[    0.000000] efi: Getting EFI parameters from FDT:
[    0.000000] efi: UEFI not found.
[    0.000000] Reserved memory: created DMA memory pool at 0x000000003ed40000, size 1 MiB
[    0.000000] OF: reserved mem: initialized node rproc@3ed400000, compatible id shared-dma-pool
[    0.000000] cma: Reserved 512 MiB at 0x000000005fc00000
.
.
.
.
Starting syslogd/klogd: done
Starting tcf-agent: OK
PetaLinux 2020.1 ultra96v2-2020-1 ttyPS0
root@ultra96v2-2020-1:~# The XKEYBOARD keymap compiler (xkbcomp) reports:
&gt; Warning:          Unsupported high keycode 372 for name &lt;I372&gt; ignored
&gt;                   X11 cannot support keycodes above 255.
&gt;                   This warning only shows for the first high keycode.
Errors from xkbcomp are not fatal to the X server
D-BUS per-session daemon address is: unix:abstract=/tmp/dbus-2CuBS4BnDn,guid=63270a6bec61460191859caa5f9022fc
matchbox: Cant find a keycode for keysym 269025056
matchbox: ignoring key shortcut XF86Calendar=!$contacts
matchbox: Cant find a keycode for keysym 2809
matchbox: ignoring key shortcut telephone=!$dates
matchbox: Cant find a keycode for keysym 269025050
matchbox: ignoring key shortcut XF86Start=!matchbox-remote -desktop
dbus-daemon[641]: Activating service name=&#39;org.a11y.atspi.Registry&#39; requested by &#39;:1.0&#39; (uid=0 pid=636 comm=&quot;matchbox-desktop &quot;)
dbus-daemon[641]: Successfully activated service &#39;org.a11y.atspi.Registry&#39;
SpiRegistry daemon is running with well-known name - org.a11y.atspi.Registry
[settings daemon] Forking. run with -n to prevent fork
</pre></div>
</div>
</li>
<li><p>Note that near the end some messages spill, so just press Enter couple of times, and you see that you need to login. Login as <code class="docutils literal notranslate"><span class="pre">root</span></code> with Password: <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@u96v2</span><span class="o">-</span><span class="n">sbc</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mi">2020</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">~</span><span class="c1">#</span>
</pre></div>
</div>
</li>
<li><p>We will now enable ethernet connection between our Ultra96 and
the host computer, such that we can copy files between
the devices. Issue the following command in the serial console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ifconfig</span> <span class="n">eth0</span> <span class="mf">10.10.7.1</span> <span class="n">netmask</span> <span class="mf">255.0.0.0</span>
</pre></div>
</div>
</li>
<li><p>Now in your second console in the host computer, first
find out the name that has been assigned to the USB-ethernet
device by issuing <code class="docutils literal notranslate"><span class="pre">ifconfig</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enx000ec6c4b500</span><span class="p">:</span> <span class="n">flags</span><span class="o">=</span><span class="mi">4163</span><span class="o">&lt;</span><span class="n">UP</span><span class="p">,</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">RUNNING</span><span class="p">,</span><span class="n">MULTICAST</span><span class="o">&gt;</span>  <span class="n">mtu</span> <span class="mi">1500</span>
        <span class="n">inet</span> <span class="mf">10.10.7.2</span>  <span class="n">netmask</span> <span class="mf">255.0.0.0</span>  <span class="n">broadcast</span> <span class="mf">10.255.255.255</span>
        <span class="n">ether</span> <span class="mi">00</span><span class="p">:</span><span class="mi">0</span><span class="n">e</span><span class="p">:</span><span class="n">c6</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="n">b5</span><span class="p">:</span><span class="mi">00</span>  <span class="n">txqueuelen</span> <span class="mi">1000</span>  <span class="p">(</span><span class="n">Ethernet</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">packets</span> <span class="mi">213</span>  <span class="nb">bytes</span> <span class="mi">32750</span> <span class="p">(</span><span class="mf">32.7</span> <span class="n">KB</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span>  <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">frame</span> <span class="mi">0</span>
        <span class="n">TX</span> <span class="n">packets</span> <span class="mi">249</span>  <span class="nb">bytes</span> <span class="mi">25958</span> <span class="p">(</span><span class="mf">25.9</span> <span class="n">KB</span><span class="p">)</span>
        <span class="n">TX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span> <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">carrier</span> <span class="mi">0</span>  <span class="n">collisions</span> <span class="mi">0</span>
<span class="n">lo</span><span class="p">:</span> <span class="n">flags</span><span class="o">=</span><span class="mi">73</span><span class="o">&lt;</span><span class="n">UP</span><span class="p">,</span><span class="n">LOOPBACK</span><span class="p">,</span><span class="n">RUNNING</span><span class="o">&gt;</span>  <span class="n">mtu</span> <span class="mi">65536</span>
        <span class="n">inet</span> <span class="mf">127.0.0.1</span>  <span class="n">netmask</span> <span class="mf">255.0.0.0</span>
        <span class="n">inet6</span> <span class="p">::</span><span class="mi">1</span>  <span class="n">prefixlen</span> <span class="mi">128</span>  <span class="n">scopeid</span> <span class="mh">0x10</span><span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
        <span class="n">loop</span>  <span class="n">txqueuelen</span> <span class="mi">1000</span>  <span class="p">(</span><span class="n">Local</span> <span class="n">Loopback</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">packets</span> <span class="mi">570887</span>  <span class="nb">bytes</span> <span class="mi">920673672</span> <span class="p">(</span><span class="mf">920.6</span> <span class="n">MB</span><span class="p">)</span>
        <span class="n">RX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span>  <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">frame</span> <span class="mi">0</span>
        <span class="n">TX</span> <span class="n">packets</span> <span class="mi">570887</span>  <span class="nb">bytes</span> <span class="mi">920673672</span> <span class="p">(</span><span class="mf">920.6</span> <span class="n">MB</span><span class="p">)</span>
        <span class="n">TX</span> <span class="n">errors</span> <span class="mi">0</span>  <span class="n">dropped</span> <span class="mi">0</span> <span class="n">overruns</span> <span class="mi">0</span>  <span class="n">carrier</span> <span class="mi">0</span>  <span class="n">collisions</span> <span class="mi">0</span>
</pre></div>
</div>
<p>In our case, the USB-ethernet device is <code class="docutils literal notranslate"><span class="pre">enx000ec6c4b500</span></code>.
Now issue the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ifconfig</span> <span class="n">enx000ec6c4b500</span> <span class="mf">10.10.7.2</span> <span class="n">netmask</span> <span class="mf">255.0.0.0</span>
</pre></div>
</div>
</li>
<li><p>We have now assigned IP <code class="docutils literal notranslate"><span class="pre">10.10.7.1</span></code> to our Ultra96 and IP <code class="docutils literal notranslate"><span class="pre">10.10.7.2</span></code> to our USB ethernet device connected to our host computer.
You can test the connection by doing <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">10.10.7.2</span></code> from the Ultra96 serial console, and doing <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">10.10.7.1</span></code> from the host
computer.</p></li>
<li><p>Let’s copy <code class="docutils literal notranslate"><span class="pre">hw4</span></code> directory to Ultra96:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="n">hw4</span> <span class="n">root</span><span class="o">@</span><span class="mf">10.10.7.1</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">root</span><span class="o">/</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows">
<span id="boot-windows"></span><h4><span class="section-number">4.2.3.2.3. </span>Boot the Ultra96 (Environment - Personal Computer or Detkin Machines with Windows)<a class="headerlink" href="#boot-the-ultra96-environment-personal-computer-or-detkin-machines-with-windows" title="Permalink to this headline">#</a></h4>
<ul>
<li><p>Connect your ultra96 jtag usb to your computer. Also connect the ethernet-usb to ultra96 and the computer. Go to device managers and note down the serial port of the usb. In the example case, it’s COM4.</p>
<figure class="align-default" id="id3">
<img alt="../_images/win_eth_0.jpg" src="../_images/win_eth_0.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 4.6 </span><span class="caption-text">Find the port</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Download and install MobaXterm from <a class="reference external" href="https://download.mobatek.net/2042020100805218/MobaXterm_Installer_v20.4.zip">here</a>.</p></li>
<li><p>Start MobaXterm. Click <em><strong>Session</strong></em> in the left top corner and select <em><strong>Serial</strong></em>.
Set the serial port as the one you found in the previous step and bps. In the example case,
it’s COM4 and 115200. Click <em><strong>OK</strong></em>.</p></li>
<li><p>Boot the board by pressing the boot switch as shown in <a class="reference internal" href="../hw5/walk_through.html#boot"><span class="std std-numref">Fig. 5.8</span></a>.</p></li>
<li><p>Note that near the end some messages spill, so just press Enter couple of times, and you see that you need to login. Login as <code class="docutils literal notranslate"><span class="pre">root</span></code> with Password: <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@u96v2</span><span class="o">-</span><span class="n">sbc</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mi">2020</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">~</span><span class="c1">#</span>
</pre></div>
</div>
</li>
<li><p>Click plus sign to open up the local machine’s session(new tab).
Type <code class="docutils literal notranslate"><span class="pre">ifconfig</span></code> and find out the ip address and netmask assigned to the USB-ethernet device. Following is the example:</p>
<figure class="align-default" id="id4">
<img alt="../_images/win_eth_1.jpg" src="../_images/win_eth_1.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 4.7 </span><span class="caption-text">ifconfig to find out your local machine’s ip</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Assign your Ultra96 an ip address on the same subnet as the USB-ethernet, e.g. from the
previous step, the ip address of the local machine is <code class="docutils literal notranslate"><span class="pre">169.254.123.23</span></code> and netmask is
<code class="docutils literal notranslate"><span class="pre">255.255.0.0</span></code>. So, let’s assign the ultra96 to a ip of <code class="docutils literal notranslate"><span class="pre">169.254.123.24</span></code>(note that
this is 24!) as follows:</p>
<figure class="align-default" id="id5">
<img alt="../_images/win_eth_2.jpg" src="../_images/win_eth_2.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 4.8 </span><span class="caption-text">Connect you machine and Ultra96</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Your devices are now connected. Go to the local machine’s tab and ssh into the Ultra96:</p>
<figure class="align-default" id="id6">
<img alt="../_images/win_eth_3.jpg" src="../_images/win_eth_3.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 4.9 </span><span class="caption-text">ssh in to the Ultra96 and transfer files</span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>You can view the files of the Ultra96 on the left hand side.
You can easily drag and drop files from/to the local machine to/from Ultra96.
Drag and drop <code class="docutils literal notranslate"><span class="pre">hw4</span></code> folder on the left hand side to start this HW.</p></li>
</ul>
</section>
</section>
</section>
<section id="running-the-code">
<h2><span class="section-number">4.2.4. </span>Running the Code<a class="headerlink" href="#running-the-code" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>There are 3 targets, which we will build <strong>in the Ultra96</strong>. You can build all of them by executing <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">all</span></code>
in the <code class="docutils literal notranslate"><span class="pre">hw4/assignment</span></code> directory. You can build separately by:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">baseline</span></code> and <code class="docutils literal notranslate"><span class="pre">./baseline</span></code> to run the project with no vectorization of
<code class="docutils literal notranslate"><span class="pre">Filter_vertical</span></code> function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">neon_filter</span></code> and <code class="docutils literal notranslate"><span class="pre">./neon_filter</span></code> to run the project with <code class="docutils literal notranslate"><span class="pre">Filter_vertical</span></code> vectorized
(you will modify the vectorized code later).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">example</span></code> and <code class="docutils literal notranslate"><span class="pre">./example</span></code> to run the neon example.</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> folder contains the input data, <code class="docutils literal notranslate"><span class="pre">Input.bin</span></code>, which has 200 frames of
size <span class="math notranslate nohighlight">\(960\)</span> by <span class="math notranslate nohighlight">\(540\)</span> pixels, where each pixel is a byte. <code class="docutils literal notranslate"><span class="pre">Golden.bin</span></code> contains the
expected output. Each program uses this file to see if there is a mismatch between
your program’s output and the expected output.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">assignment/common</span></code> folder has header files and helper functions used by the
four parts.</p></li>
<li><p>You will mostly be working with the code in the <code class="docutils literal notranslate"><span class="pre">assignment/src</span></code> folder.</p></li>
</ul>
</section>
<section id="working-with-neon">
<h2><span class="section-number">4.2.5. </span>Working with NEON<a class="headerlink" href="#working-with-neon" title="Permalink to this headline">#</a></h2>
<p>We are going to do some reading from the arm developer website articles and
the NEON Programmer’s Guide in the following sections.</p>
<section id="basics">
<h3><span class="section-number">4.2.5.1. </span>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">#</a></h3>
<p>Read <a class="reference external" href="https://developer.arm.com/architectures/instruction-sets/simd-isas/neon/neon-programmers-guide-for-armv8-a/introducing-neon-for-armv8-a/single-page">Introducing Neon for Armv8-a</a> and answer the
following questions. We have given you the answers, however make sure you
do the reading! Knowing where to look in a programmer’s
guide is a skill by itself and we want to learn it now rather than later.</p>
<div class="dropdown admonition">
<p class="admonition-title">1. Give an example of a SISD instruction.</p>
<p><code class="docutils literal notranslate"><span class="pre">add</span> <span class="pre">r0,</span> <span class="pre">r5</span></code></p>
<p>and any instruction from the <a class="reference download internal" download="" href="../_downloads/c41cbc11e03ca7fc78a366e3e8eac3cf/QRC0001_UAL.pdf"><code class="xref download docutils literal notranslate"><span class="pre">ARM</span> <span class="pre">and</span> <span class="pre">Thumb-2</span> <span class="pre">ISA</span> <span class="pre">quick</span> <span class="pre">reference</span> <span class="pre">guide</span></code></a></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">2. Give an example of a SIMD instruction.</p>
<p><code class="docutils literal notranslate"><span class="pre">add</span> <span class="pre">v10.4s,</span> <span class="pre">v8.4s,</span> <span class="pre">v9.4s</span></code></p>
<p>and any instruction from the <a class="reference external" href="https://community.arm.com/developer/tools-software/oss-platforms/b/android-blog/posts/arm-neon-programming-quick-reference">NEON quick reference guide</a></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">3. What is the size of a register in a Armv8-A NEON unit?</p>
<p>128-bit</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">4. What does a NEON register contain?</p>
<p>vectors of elements of the same data type</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">5. How many sizes of NEON vectors are there and what are those sizes?</p>
<p>Two sizes: 64-bit and 128-bit NEON vectors</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">6. What is a lane?</p>
<p>The same element position in the input and output registers is referred to as a lane.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">7. How many lanes are there in a uint16x8_t NEON vector data type?</p>
<p>8</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">8. How many lanes are there in a uint32x2_t NEON vector data type?</p>
<p>2</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">9. Can there be a carry or overflow from one lane to another?</p>
<p>No.</p>
</div>
<hr class="docutils" />
<p>Read <a class="reference external" href="https://developer.arm.com/documentation/den0024/a/armv8-registers/neon-and-floating-point-registers">NEON and floating-point registers</a> and answer the
following questions:</p>
<div class="dropdown admonition">
<p class="admonition-title">1. How many NEON registers are there in ARMv8 and what are they labeled as?</p>
<p>32 128-bit NEON registers, labeled as V0-V31.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">2. What is the difference between an operand labeled v0.16b and an operand labeled q0?</p>
<p>v0.16b is a vector register and has 16 lanes with each lane having 1 byte.
q0 is a scalar register of 128-bits.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">3. Are registered labeled b0, h0, s0, d0, q0 separate registers?</p>
<p>No, all of them belong to the same register v0. They are qualified names for registers when a NEON instruction operate on scalar data.</p>
</div>
<hr class="docutils" />
<p>Read chapter four from the <a class="reference download internal" download="" href="../_downloads/b8a011355a55096090c5b62e49f605c7/neon_programmers_guide.pdf"><code class="xref download docutils literal notranslate"><span class="pre">NEON</span> <span class="pre">Programmer's</span> <span class="pre">Guide</span></code></a> and answer the following questions:</p>
<div class="dropdown admonition">
<p class="admonition-title">1. Where are the NEON Intrinsics declared?</p>
<p>in <code class="docutils literal notranslate"><span class="pre">arm_neon.h</span></code> header file</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">2. What NEON data type are you going to use for an unsigned char array of size 16 elements?</p>
<p>uint8x16_t. It will got to Q register.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">3. When should you use intrinsics with ‘q’ suffix vs intrinsics without ‘q’ suffix?</p>
<p>When the input and output vectors are 64-bit vectors, don’t use intrinsics with ‘q’ suffix.
When the input and output vectors are 128-bit vectors, do use intrinsics with ‘q’ suffix.</p>
</div>
</section>
<section id="coding-with-neon-intrinsics">
<span id="coding-neon"></span><h3><span class="section-number">4.2.5.2. </span>Coding with NEON Intrinsics<a class="headerlink" href="#coding-with-neon-intrinsics" title="Permalink to this headline">#</a></h3>
<p>Read chapter four from the NEON Programmer’s Guide and answer the following questions.
Use the <a class="reference external" href="https://developer.arm.com/architectures/instruction-sets/simd-isas/neon/intrinsics">Neon Intrinsics Reference</a> website to find and understand any instruction.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This will help you in coding for your homework.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">1. Which intrinsic should you use to duplicate a scalar value to a variable of type uint16x8_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vdupq_n_u16</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">2. Which intrinsic should you use to load 16 bytes from a pointer to a variable of type uint8x16_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vld1q_u8</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">3. Which intrinsic should you use to add two vectors of type uint8x8_t without overflowing?</p>
<p><code class="docutils literal notranslate"><span class="pre">vaddl_u8</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">4. Which intrinsic should you use to get the first 8 lanes (low) of a variable of type uint8x16_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vget_low_u8</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">5. Which intrinsic should you use to get the second 8 lanes (high) of a variable of type uint8x16_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vget_high_u8</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">6. Which intrinsic should you use to multiply two vectors of type uint16x8_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vmulq_u16</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">7. Which intrinsic should you use to multiply two vectors of type uint16x8_t and accumlate the result to a variable of type uint16x8_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vmlaq_u16</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">8. Which intrinsic should you use to shift a variable of type uint16x8_t to the right?</p>
<p><code class="docutils literal notranslate"><span class="pre">vshrq_n_u16</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">9. Which intrinsic should you use to cast the uint8_t values in a variable of type uint8x8_t to be uint16_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vmovl_u8</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">10. Which intrinsic should you use to cast the uint16_t values in a variable of type uint16x8_t to be uint8_t?</p>
<p><code class="docutils literal notranslate"><span class="pre">vmovn_u16</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">11. Which intrinsic should you use to join two uint8x8_t vectors into a uint8x16_t vector?</p>
<p><code class="docutils literal notranslate"><span class="pre">vcombine_u8</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">12. Which intrinsic should you use to store data from a uint8x16_t variable to a pointer?</p>
<p><code class="docutils literal notranslate"><span class="pre">vst1q_u8</span></code></p>
</div>
</section>
<section id="optimization">
<h3><span class="section-number">4.2.5.3. </span>Optimization:<a class="headerlink" href="#optimization" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Read section 2.1.10, 2.8, and chapter 5 from the NEON Programmer’s Guide.</p></li>
<li><p>Watch the talk: <a class="reference external" href="https://youtu.be/ixuDntaSnHI">Taming ARMv8 NEON: from theory to benchmark results</a></p></li>
<li><p>Read (supplemental) <a class="reference external" href="https://developer.arm.com/architectures/instruction-sets/simd-isas/neon/neon-programmers-guide-for-armv8-a/optimizing-c-code-with-neon-intrinsics/single-page">Optimizing C Code with Neon Intrinsics</a></p></li>
<li><p>Read (supplemental) <a class="reference external" href="https://developer.arm.com/architectures/instruction-sets/simd-isas/neon/neon-programmers-guide-for-armv8-a/coding-for-neon/single-page">Coding for NEON</a></p></li>
<li><p>Read (supplemental) <a class="reference external" href="https://developer.arm.com/architectures/instruction-sets/simd-isas/neon/neon-programmers-guide-for-armv8-a/neon-intrinsics-chromium-case-study/single-page">Neon Intrinsics Chromium Case Study</a></p></li>
<li><p>Read (supplemental) <a class="reference external" href="http://www.cs.utexas.edu/~pingali/CS377P/2017sp/lectures/david-vectorization.pdf">Program Optimization through Loop Vectorization</a></p></li>
</ul>
</section>
<section id="more-resources">
<h3><span class="section-number">4.2.5.4. </span>More Resources:<a class="headerlink" href="#more-resources" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://community.arm.com/developer/tools-software/oss-platforms/b/android-blog/posts/arm-neon-programming-quick-reference">NEON Quick reference guide</a></p></li>
<li><p><a class="reference external" href="https://developer.arm.com/architectures/instruction-sets/simd-isas/neon/intrinsics">NEON Intrinsics Reference</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./hw4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="collaboration.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.1. </span>Collaboration</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="homework_submission.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>Homework Submission</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Department of Electrical and Systems Engineering<br/>
  
      &copy; Copyright 2022 Department of Electrical and Systems Engineering at the University of Pennsylvania.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>